# commit\_diff

> Переводы: [EN](./README.md), [RU](./README-ru.md)

Удобный CLI-инструмент для генерации шаблона сообщения коммита на основе ваших подготовленных изменений git (или последнего коммита) с использованием настраиваемых шаблонов.
Поддерживает автоматическую подстановку diff, branch и locale в шаблон.

## Оглавление

- [Возможности](#возможности)
- [Установка](#установка)
- [Использование](#использование)
- [Плейсхолдеры](#плейсхолдеры)
- [Пример использования](#пример-использования)
- [Заметки](#заметки)
- [Лицензия](#лицензия)

---

## Возможности

* Вставляет краткое описание изменений из git diff или последнего коммита в шаблон
* Позволяет использовать плейсхолдеры (`{diff}`, `{branch}`, `{locale}`) в файлах-шаблонах `.tpl`
* Автоматически выбирает шаблон, если найден только один
* Показывает подробные ошибки, если шаблонов несколько
* Поддерживает подстановку локали (например, `en` → English, `ru` → Russian)
* Выводит результат в stdout (можно перенаправить или скопировать)

---

## Установка

Можно установить с помощью `curl` или `wget`:

```sh
curl -fsSL https://raw.githubusercontent.com/Soloton/commit_diff/master/install.sh | bash
```

или

```sh
wget -qO- https://raw.githubusercontent.com/Soloton/commit_diff/master/install.sh | bash
```

После установки:

- Скрипт доступен как `commit_diff` (проверить можно командой `commit_diff --help`).

- Шаблоны находятся в каталоге `/usr/local/share/commit_diff/`.
Вы можете добавлять туда свои файлы `*.tpl`.

Если после установки команда commit_diff недоступна, убедитесь, что каталог `/usr/local/bin` есть в переменной окружения `PATH`.
Для этого добавьте строку в `~/.bashrc` или `~/.zshrc`:

``` sh
export PATH=$PATH:/usr/local/bin
```

---

## Использование

```sh
commit_diff [ОПЦИИ]
```

**Опции:**

* `-t`, `--template NAME`
  Использовать указанный файл шаблона (`*.tpl`) из каталога скрипта.
* `-l`, `--locale LOCALE`
  Установить локаль (например, `en` или `ru`). Если не найдено в карте, подставляется как есть.
* `-L`, `--list`
  Показать список доступных файлов-шаблонов.
* `-a`, `--last-commit`
  Использовать изменения из последнего коммита вместо подготовленных (`{diff}`).
* `-h`, `--help`
  Показать справку.

Если шаблон не указан и в каталоге есть только один `.tpl`, он будет выбран автоматически.

---

## Плейсхолдеры

* `{diff}` — заменяется на вывод `git diff --cached` (или diff последнего коммита, если используется `-a`)
* `{branch}` — заменяется на имя текущей ветки git
* `{locale}` — заменяется на строку, соответствующую локали (например, `en` → English)

---

## Пример использования

1. **Подготовьте файл-шаблон**
   Поместите ваш файл `my_template.tpl` в ту же директорию, что и `commit_diff.sh`.
   Пример шаблона:

   ```
   feat({branch}): commit for {locale}

   - Список изменений:
   {diff}
   ```

2. **Используйте в вашем git-проекте**

   ```sh
   git add <файлы>
   commit_diff -t my_template -l ru
   ```

   или для вывода изменений последнего коммита:

   ```sh
   commit_diff -t my_template -l ru -a
   ```

3. **Скопируйте или перенаправьте результат для сообщения коммита или описания PR.**

---

## Заметки

* Запускать `commit_diff` нужно внутри git-репозитория.
* Файлы шаблонов должны иметь расширение `.tpl` и находиться в той же директории, что и `commit_diff.sh`.
* Если шаблонов несколько, используйте опцию `-t`.

---

## Лицензия

MIT

---

*Будем рады предложениям и замечаниям!*
