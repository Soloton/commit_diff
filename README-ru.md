# commit_diff — CLI‑инструмент для генерации сообщения коммита

Русская версия README: [EN](./README.md), [RU](./README-ru.md)

Удобный CLI‑инструмент для генерации шаблона сообщения коммита на основе staged в Git (или последнего коммита), с поддержкой настраиваемых шаблонов. Обеспечивается автоматическая подстановка `{diff}`, `{branch}` и `{locale}`.

---

## Оглавление

* [Возможности](#возможности)
* [Установка](#установка)
* [Использование](#использование)
* [Плейсхолдеры](#плейсхолдеры)
* [Примеры](#примеры)
* [Заметки](#заметки)
* [Лицензия](#лицензия)

---

## Возможности

* Вставка краткого описания изменений из `git diff --cached` или последнего коммита
* Поддержка плейсхолдеров `{diff}`, `{branch}`, `{locale}` в шаблонах `*.tpl`.
* Автоматический выбор шаблона, если в каталоге только один файл.
* Подробные сообщения об ошибках при наличии нескольких шаблонов.
* Поддержка локализации (`en` → English, `ru` → Russian).
* Вывод результата в `stdout` (можно перенаправить или скопировать).

---

## Установка

Установите с помощью `curl` или `wget`:

```sh
curl -fsSL https://raw.githubusercontent.com/Soloton/commit_diff/master/install.sh | bash
```

или

```sh
wget -qO- https://raw.githubusercontent.com/Soloton/commit_diff/master/install.sh | bash
```

После установки:

* Скрипт доступен как `commit_diff` (проверьте командой `commit_diff --help`).
* Шаблоны расположены в `/usr/local/share/commit_diff/`. Можно добавлять туда собственные файлы `*.tpl`.

Если команда `commit_diff` не найдена, убедитесь, что `/usr/local/bin` включён в `$PATH`. Обычно этого не требуется, но при необходимости добавьте в `~/.bashrc` или `~/.zshrc`:

```sh
export PATH="$PATH:/usr/local/bin"
```

---

## Использование

```sh
commit_diff [OPTIONS]
```

**Опции:**

* `-t`, `--template NAME` — использовать указанный шаблон `NAME.tpl`.
* `-l`, `--locale LOCALE` — установить локаль (`en` или `ru`). Если не распознано, используется `LOCALE` как есть.
* `-L`, `--list` — показать список доступных шаблонов.
* `-a`, `--last-commit` — использовать изменения из последнего коммита вместо staged diff.
* `-h`, `--help` — показать справку.

Если шаблон не указан и в каталоге только один файл `*.tpl`, он будет выбран автоматически.

---

## Плейсхолдеры

* `{diff}` — diff изменений из staged (`git diff --cached`) или последнего коммита при использовании `-a`.
* `{branch}` — имя текущей ветки Git.
* `{locale}` — название локали (`en` → English, `ru` → Russian).

---

## Примеры

1. Пример использования своего шаблона

    1. Подготовьте свой шаблон `my_template.tpl` и расположите его в `/usr/local/share/commit_diff/`.
    2. Внутри вашего проекта выполните:

    ```sh
    git add <файлы>
    commit_diff -t my_template -l ru
    ```

    или:

    ```sh
    commit_diff -t my_template -l ru -a
    ```

    3. Скопируйте результат и вставьте в сообщение коммита или описание PR.

2. Пример использования шаблона, если шаблон в общем каталоге один

    1. Внутри вашего проекта выполните:

    ```sh
    git add <файлы>
    commit_diff | xclip -sel clip
    ```

    или:

    ```sh
    commit_diff -a | xclip -sel clip
    ```

    2. Скопируйте результат и вставьте в сообщение коммита или описание PR.

---

## Заметки

* Запускать `commit_diff` следует внутри Git-репозитория.
* Шаблоны `*.tpl` хранятся в общем каталоге `/usr/local/share/commit_diff/`.
* Если шаблонов несколько, указывайте нужный с помощью `-t`.

---

## Лицензия

MIT

Будем рады предложениям и замечаниям!
